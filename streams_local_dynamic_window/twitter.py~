import sys
from os import path
sys.path.append( path.dirname( path.dirname( path.abspath(__file__) ) ) )

from functools import partial
from Stream import Stream, _no_value
from Agent import *
from Operators import stream_func

import numpy as np

import tweepy
from tweepy.streaming import StreamListener
from tweepy import OAuthHandler
import json

import pdb

access_token = "3286035757-eZ7hCq2z05lIfXDZlpzVwGZXRtWlDpQY2Ay9OGr"
access_token_secret = "ZE6vYdbYxXGFTNtsZ4dYELMzsyictDSYzhIu3KfONrlRT"
consumer_key = "aJ68lwHUGqD2TGqYDteYmPbZY"
consumer_secret = "I1GLYYyNF6nNWASzGrq6YV4cPwah5T10eRwnYqLxKCkR6kAYWB"

x = Stream('x')

class StdOutListener(StreamListener):

    def on_data(self, data):
        try:
            data_json = json.loads(data)
            print data_json['text']
            x.extend([data_json['text']])
        except:
            pass
        return True

    def on_error(self, status):
        print status

if __name__ == '__main__':

    l = StdOutListener()
    auth = OAuthHandler(consumer_key, consumer_secret)
    auth.set_access_token(access_token, access_token_secret)
    stream = tweepy.Stream(auth, l)

    stream.filter(track=['pluto'])
